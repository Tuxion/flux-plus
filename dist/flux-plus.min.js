!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r;"undefined"!=typeof window?r=window:"undefined"!=typeof global?r=global:"undefined"!=typeof self&&(r=self),r.FluxPlus=t()}}(function(){return function t(r,e,n){function o(s,a){if(!e[s]){if(!r[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var p=e[s]={exports:{}};r[s][0].call(p.exports,function(t){var e=r[s][1][t];return o(e?e:t)},p,p.exports,t,r,e,n)}return e[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(t,r){r.exports={ActionSource:{CLIENT:"CLIENT",SERVER:"SERVER"},EntityOperation:{MERGE:"MERGE",DELETE:"DELETE",REPLACE:"REPLACE"}}},{}],2:[function(t,r){var e,n={}.hasOwnProperty,o=function(t,r){function e(){this.constructor=t}for(var o in r)n.call(r,o)&&(t[o]=r[o]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};r.exports=e=function(t){function r(t){this.message=t,this.name="InvalidArgumentError",r.__super__.constructor.apply(this,arguments)}return o(r,t),r}(Error)},{}],3:[function(t,r){var e,n={}.hasOwnProperty,o=function(t,r){function e(){this.constructor=t}for(var o in r)n.call(r,o)&&(t[o]=r[o]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};r.exports=e=function(t){function r(t){this.message=t,this.name="ValidationError",r.__super__.constructor.apply(this,arguments)}return o(r,t),r}(Error)},{}],4:[function(t,r){var e,n,o;o=t("src/actions/constants"),e=o.ActionSource,n=o.EntityOperation,r.exports={errors:t("src/errors"),Dispatcher:t("src/dispatcher/dispatcher"),Action:t("src/actions/action"),ActionSource:e,EntityOperation:n,BaseStore:t("src/stores/base-store")}},{"src/actions/action":5,"src/actions/constants":6,"src/dispatcher/dispatcher":7,"src/errors":8,"src/stores/base-store":9}],5:[function(t,r){var e,n,o,i,s;s=t("./constants"),n=s.ActionSource,o=s.EntityOperation,i=t("src/errors").ValidationError,r.exports=e=function(){function t(){this.active={},this.entities={},this.payload={}}return t.prototype.name=null,t.prototype.source=null,t.prototype.active=null,t.prototype.entities=null,t.prototype.payload=null,t.prototype.validate=function(){var t,r,e,s;if(!this.name)throw new i("Action name is not defined.");if(!n[this.source])throw new i("Source '"+this.source+"' is not a valid ActionSource.");e=this.payload,s=[];for(r in e){if(t=e[r],!this.entities[r])throw new i("Payload with key '"+r+"' is not defined in the entities.");if(!o[this.entities[r]])throw new i("Entity '"+r+"' has an invalid EntityOperation '"+this.entities[r]+"'.");if(!Array.isArray(t))throw new i("Payload with key '"+r+"' is not an Array.");s.push(void 0)}return s},t}()},{"./constants":1,"src/errors":8}],6:[function(t,r){r.exports={ActionSource:{CLIENT:"CLIENT",SERVER:"SERVER"},EntityOperation:{MERGE:"MERGE",DELETE:"DELETE",REPLACE:"REPLACE"}}},{}],7:[function(t,r){var e,n,o,i={}.hasOwnProperty,s=function(t,r){function e(){this.constructor=t}for(var n in r)i.call(r,n)&&(t[n]=r[n]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};o=t("src/errors").InvalidArgumentError,e=t("src/actions/action"),r.exports=n=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return s(r,t),r.prototype.dispatch=function(t){if(!(t instanceof e))throw new o("Payload must be an instance of Action.");return t.validate(),r.__super__.dispatch.apply(this,arguments)},r}(Flux.Dispatcher)},{"src/actions/action":5,"src/errors":8}],8:[function(t,r){r.exports={ValidationError:t("./validation-error"),InvalidArgumentError:t("./invalid-argument-error")}},{"./invalid-argument-error":2,"./validation-error":3}],9:[function(t,r){var e,n,o,i,s,a,c,u,p={}.hasOwnProperty,f=function(t,r){function e(){this.constructor=t}for(var n in r)p.call(r,n)&&(t[n]=r[n]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t};u=t("src/actions/constants"),e=u.ActionSource,i=u.EntityOperation,s=t("src/errors").InvalidArgumentError,o=t("src/dispatcher/dispatcher"),a={},c={active:null},r.exports=n=function(t){function r(t){if(!(t instanceof o))throw new s("An instance of FluxPlus.Dispatcher should be provided.");if(null==this.elementName)throw new Error('The property "elementName" must be set on implementations of the BaseStore.');this.dispatcherIndex=t.register(function(t){return function(r){return t.handleAction(r)}}(this))}return f(r,t),r.prototype.elementName=null,r.prototype.extractId=function(t){return t.id},r.prototype.extractActive=function(t){var r,e;return r=null!=(e=t.active)?e[this.elementName]:void 0,void 0===r?!1:r},r.prototype.getActive=function(){return c.active},r.prototype.getOne=function(t){return t instanceof Object&&(t=this.extractId(t)),a[t]||null},r.prototype.getAll=function(){var t,r,e;t={};for(r in a)e=a[r],t[r]=e;return t},r.prototype.handleAction=function(t){var r,n,o,s,u,p,f,l,h,d,E;if(r=this.extractActive(t),r!==!1&&(c.active=r,t.source=e.CLIENT))return void this.emit("change");if(t.source===e.SERVER&&t.entities[this.elementName]){switch(t.entities[this.elementName]){case i.REPLACE:for(a={},h=t.payload[this.elementName],o=0,p=h.length;p>o;o++)n=h[o],a[this.extractId(n)]=n;break;case i.MERGE:for(d=t.payload[this.elementName],s=0,f=d.length;f>s;s++)n=d[s],a[this.extractId(n)]=n;break;case i.DELETE:for(E=t.payload[this.elementName],u=0,l=E.length;l>u;u++)n=E[u],delete a[this.extractId(n)]}this.emit("change")}},r}(EventEmitter)},{"src/actions/constants":6,"src/dispatcher/dispatcher":7,"src/errors":8}]},{},[4])(4)});